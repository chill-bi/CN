import java.io.*;
import java.net.*;
import java.util.Scanner;
public class StopAndWaitServer {
public static void main(String[] args) throws Exception {
ServerSocket ss = new ServerSocket(8080);
System.out.println("Server waiting for client...");
Socket socket = ss.accept();
System.out.println("Client connected.");
DataOutputStream out = new DataOutputStream(socket.getOutputStream());
DataInputStream in = new DataInputStream(socket.getInputStream());
Scanner sc = new Scanner(System.in);
System.out.print("Enter total number of frames to send: ");
int totalFrames = sc.nextInt();
int seq = 0; // 1-bit sequence number
for (int frame = 0; frame < totalFrames;) {
System.out.println("Sending frame " + frame + " with seq=" + seq);
out.writeInt(frame);
out.writeInt(seq);
out.flush();
int ackSeq = in.readInt(); // receive ACK seq number
System.out.println("Received ACK for seq=" + ackSeq);
if (ackSeq == seq) {
System.out.println("ACK OK. Moving to next frame.\n");
seq = 1 - seq; // alternate sequence number
frame++; // send next frame
} else {
System.out.println("Wrong ACK! Resending frame...\n");
// automatically retries (frame not incremented)
}
}
System.out.println("All frames sent successfully.");
out.close();
in.close();
socket.close();
ss.close();
}
}





import java.io.*;
import java.net.*;
public class StopAndWaitClient {
public static void main(String[] args) throws Exception {
Socket socket = new Socket("localhost", 8080);
System.out.println("Connected to server.");
DataInputStream in = new DataInputStream(socket.getInputStream());
DataOutputStream out = new DataOutputStream(socket.getOutputStream());
int expectedSeq = 0;
while (true) {
try {
int frame = in.readInt();
int seq = in.readInt();
System.out.println("Received frame " + frame + " with seq=" + seq);
if (seq == expectedSeq) {
System.out.println("Frame " + frame + " is correct.");
out.writeInt(seq); // ACK
expectedSeq = 1 - expectedSeq; // alternate seq number
} else {
System.out.println("Frame out of order! Sending previous ACK.");
out.writeInt(1 - expectedSeq); // send previous ACK
}
System.out.println();
} catch (EOFException e) {
System.out.println("Transmission complete.");
break;
}
}
in.close();
out.close();
socket.close();
}
}

